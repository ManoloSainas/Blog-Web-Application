<%# Inserimento header %> 
<%- include("partials/header.ejs") %> 

<%# Form perinserire un nuovo post %>
<div class="form-homepage">
  <h3 class="h3">Insert a new post</h3>
  <form action="/submit" method="POST">
    <div class="mb-3">
      <label class="form-label" for="title">Title:</label>
      <input
        class="form-control"
        type="text"
        name="title"
        id="title"
        required
      />
    </div>
    <div class="mb-3">
      <label class="form-label" for="blogPost">Blog Post:</label>
      <textarea
        class="form-control"
        name="blogPost"
        rows="6"
        id="blogPost"
        required
      ></textarea>
    </div>
    <div class="send-post-button">
      <button class="btn btn-primary" type="submit">Send post</button>
    </div>
  </form>
</div>

<hr class="border border-1 opacity-75" />

<%# Mostra il post, se presente. In caso contrario mostra "No posts yet" %> 
<%# Attraverso due bottoni è possibile scorrere tra i vari post %> 
<%# Ogni post è composto dalla data in cui è stato inserito, dal titolo e dal testo del post %>
<div class="container mt-5 post">
  <% if(posts.length === 0){ %>
  <h3 class="text-center text-muted">No posts yet</h3>
  <% } else { %> <% const post = posts[selectedIndex]; %>

  <div class="d-flex gap-3">
    <div class="d-flex align-items-center">
      <a href="/prev" class="btn btn-outline-secondary btn-lg mx-2">
        <i class="bi bi-arrow-left"></i>
      </a>
    </div>

    <div class="border rounded p-3 mb-3">
      <h4>Date:</h4>
      <p class="fw-light"><%= post.date %></p>
      <h4>Title:</h4>
      <p class="fw-light multiline-truncate" style="max-width: 150px">
        <%= post.title %>
      </p>
      <h4>Post:</h4>
      <p class="fw-light multiline-truncate" style="max-width: 150px">
        <%= post.body %>
      </p>

      <%# Form per editare il post e per cancellarlo %>
      <div class="d-flex gap-2 justify-content-center">
        <form
          action="/editPost?index=<%= selectedIndex %>"
          method="GET"
          class="m-0"
        >
          <input type="hidden" name="index" value="<%= selectedIndex %>" />
          <button type="submit" class="btn btn-warning btn-sm">Edit</button>
        </form>
        <form action="/deletePost" method="POST" class="m-0">
          <input type="hidden" name="index" value="<%= selectedIndex %>" />
          <button type="submit" class="btn btn-danger btn-sm">Delete</button>
        </form>
      </div>
    </div>

    <div class="d-flex align-items-center">
      <a href="/next" class="btn btn-outline-secondary btn-lg mx-2">
        <i class="bi bi-arrow-right"></i>
      </a>
    </div>
  </div>
  <% } %>
</div>

<%# Inserimento footer %> 
<%- include("partials/footer.ejs") %>
